<!DOCTYPE html>
<html>
<head>
<title>Hall of fame</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="color-scheme" content="dark light">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<script src="js/cards.js?v=1"></script>
<script src="js/listings.js?v=1"></script>
<script>
allCardModels = allCardModels.data.allCardModels;

// main
async function main() {
  ranks = (await fetchHallOfFame())['hits'];
  let t = "", pos = 1;
  for( const u of ranks ) {
    let nbCardsDiff = (u.cScore / 1000000).toFixed(0);
    let score = (100*nbCardsDiff/allCardModels.length).toFixed(0);
    let nbCards = u.cScore % 1000000;

    if( pos==1 ) icon = "ü•á";
    else if( pos==2 ) icon = "ü•à";
    else if( pos==3 ) icon = "ü•â";
    else icon = pos;

    let cl = "";
    if( pos<=10 ) cl = "top10";
    else if( pos<=50 ) cl = "top50";

    let url1 = "user.html?user=" + u.username;
    let url2 = "https://rules.art/user/" + u.username + "/cards";
    let name = "<a href='" + url1 + "'>" + u.username +"</a>"
             + " <a href='" + url2 + "' target='_blank'><img src='img/rules-logo.png'></a>";

    t += `<tr class="${cl}"><th>${icon}</th><th>${name}</th><th>${score}%</th><th>${nbCards}</th></tr>`;
    pos++;
  }
  const tableRef = document.querySelector("#tableRank tbody");
  tableRef.innerHTML = t;
}

document.addEventListener("DOMContentLoaded", function() {
  main();
});

</script>
<style>
  body {font-family: Roboto,Helvetica;}
  table {border-collapse: collapse; text-align: right; font-size: 14px; border: 1px #555 solid; float:left; margin-right: 10px;}
  @media (prefers-color-scheme: dark) { a {color: #CCC;} }
  @media (prefers-color-scheme: light) { a {color: #000;} }
  a {text-decoration: none;}
  a:hover {text-decoration: underline;}
  th {font-weight: normal; text-align: center;}
  .emoji {font-size: 9pt; }
  #update, #missing {color: #777;}
  #menu, #options, #infos {float:left;}
  #menu, #infos {margin-top: -2px;}
  #menu a:hover {color: transparent; text-decoration: none; text-shadow: 0 0 0 #9f04dc;}
  #tables {clear: both; padding-top: 2px;}
  .top10 {background-color: #ff980010;}
  .top50 {background-color: #88888820;}
</style>
</head>
<body>
<div id="menu">
  <a href="index.html">üõí</a>
  <a href="transfers.html">üßæ</a>
  <a href="user.html">ü§ë</a>
  <a href="fee.html">üí∏</a>
  <a href="packs.html">üÉè</a>
  <a href="fame.html">üèÖ</a>
</div>
<div id="infos">
  <span id="update"></span>
</div>

<div id="tables">
  <table id="tableRank" border="1" style="display: table;">
    <thead>
      <tr>
        <th>Rang</th>
        <th>Utilisateur</th>
        <th>%</th>
        <th>cartes</th>
     </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
</div>
</body>
</html>
