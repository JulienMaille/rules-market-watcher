<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="refresh" content="300" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="costs.js"></script>
<script>
function main() {
  fetchEthPrice().then(json => {
    ethEurRate = parseInt(json.data.amount);

    document.querySelector("#hour").innerHTML = "aujourd'hui Ã  " + (new Date).toLocaleTimeString() + "<br>ils s'Ã©lÃ¨vent Ã  :";

    fetchGasPrice().then(json => {
      let gasPrice = parseInt(json.gas_price, 16)/10**18;
      let feeETH = gasPrice*giftGasUsage;
      let feeEUR = feeETH*ethEurRate;
      let col = "ðŸŸ¢";
      if( feeEUR> 0.6 ) col = "ðŸ”¥";
      else if( feeEUR> 0.4 ) col = "ðŸ”´";
      else if( feeEUR> 0.2 ) col = "ðŸŸ¡";
      document.querySelector("#feeicon").innerHTML = col;

      document.querySelector("#feeGiftETH").innerHTML = feeETH.toFixed(7) + " ETH";
      document.querySelector("#feeGiftEUR").innerHTML = feeEUR.toFixed(2);
      document.querySelector("#maxFeeGiftETH").innerHTML = (1.5*feeETH).toFixed(7) + " ETH";
      document.querySelector("#maxFeeGiftEUR").innerHTML = (1.5*feeEUR).toFixed(2);

      feeETH = gasPrice*sellGasUsage;
      feeEUR = feeETH*ethEurRate;
      document.querySelector("#feeSellETH").innerHTML = feeETH.toFixed(7) + " ETH";
      document.querySelector("#feeSellEUR").innerHTML = feeEUR.toFixed(2);
      document.querySelector("#maxFeeSellETH").innerHTML = (1.5*feeETH).toFixed(7) + " ETH";
      document.querySelector("#maxFeeSellEUR").innerHTML = (1.5*feeEUR).toFixed(2);

      feeETH = gasPrice*buyGasUsage;
      feeEUR = feeETH*ethEurRate;
      document.querySelector("#feeBuyETH").innerHTML = feeETH.toFixed(7) + " ETH";
      document.querySelector("#feeBuyEUR").innerHTML = feeEUR.toFixed(2);
      document.querySelector("#maxFeeBuyETH").innerHTML = (1.5*feeETH).toFixed(7) + " ETH";
      document.querySelector("#maxFeeBuyEUR").innerHTML = (1.5*feeEUR).toFixed(2);

      setTimeout(() => {main();}, 5*60*1000); // refresh in 5 mins
    });
  });
}
document.addEventListener('DOMContentLoaded', function() {
  main();
});
</script>
<style>
  body {background-color: black; color: #CCC; font-size: 19pt; font-family: Roboto,Helvetica; text-align: right;}
  #menu a {text-decoration: none;}
  #menu a:hover {color: transparent; text-shadow: 0 0 0 #9f04dc;}
  #text, #melon {float: left; margin-right: 40px;}
  #hour {color: #9f04dc;}
  .fee {color: #9f04dc;}
  #feeGiftETH, #maxFeeGiftETH, #feeSellETH, #maxFeeSellETH, #feeBuyETH, #maxFeeBuyETH {color: #CCC;}
  #feeicon {animation: scaleIn .8s infinite linear}
  @keyframes scaleIn {
    from {opacity: 1; transform: scale(.75, .75); }
    to { opacity: 0; transform: scale(1.75, 1.75); }
  }
</style>
</head>
<body>
  <div id="text">
  <div id="menu">
    <a href='index.html'>ðŸ›’</a>
    <a href='transfers.html'>ðŸ§¾</a>
    <a href='user.html'>ðŸ¤‘</a>
    <a href='fee.html'>ðŸ’¸</a>
  </div>
    <div id="combien">A combien sont les frais<br>des transactions Rules ?</div>
    <div id="hour"></div>
    <br>
    <div id="gift"><span id="feeicon"></span>Echange</div>
    <div class="fee"><span id="feeGiftETH"></span> (<span id="feeGiftEUR"></span>â‚¬)</div>
    <div class="fee">Max <span id="maxFeeGiftETH"></span> (<span id="maxFeeGiftEUR"></span>â‚¬)</div>
    <br>
    <div id="sell">Mise en vente</div>
    <div class="fee"><span id="feeSellETH"></span> (<span id="feeSellEUR"></span>â‚¬)</div>
    <div class="fee">Max <span id="maxFeeSellETH"></span> (<span id="maxFeeSellEUR"></span>â‚¬)</div>
    <br>
    <div id="buy">Achat</div>
    <div class="fee"><span id="feeBuyETH"></span> (<span id="feeBuyEUR"></span>â‚¬)</div>
    <div class="fee">Max <span id="maxFeeBuyETH"></span> (<span id="maxFeeBuyEUR"></span>â‚¬)</div>
  </div>
  <img id="melon" src="rules_Melon_R.png" />
</body>
</html>
